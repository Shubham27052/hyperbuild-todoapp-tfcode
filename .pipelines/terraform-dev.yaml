trigger:
  paths:
    include:
      - environments/dev/*

      
variables:
 - group: terraform-secrets


stages:
  - stage: TerraformDeployment
    displayName: Terraform CI/CD
    jobs:
      - job: DeployDevEnv
        displayName: "Deploy Dev environment"
        pool:
            name: noteapp-agents
        steps:   
            - template: templates/template-steps.yaml
              parameters:
                environment: dev

            - script: |
                cd $(Build.SourcesDirectory)/environments/dev/                
                terraform apply -auto-approve tfplan
              displayName: 'Terraform Apply'
